#include "stdafx.h"
#include "XeCrypt.h"


BYTE XORTable[64] = {
	0xA9, 0x08, 0xD7, 0x09, 0xDF, 0x87, 0x98, 0xDF, 0x79, 0xD8, 0x7C, 0x9A,
	0x8D, 0x7C, 0x90, 0x8A, 0x7C, 0x09, 0xA8, 0xD7, 0xF9, 0x0A, 0x8D, 0x7F,
	0x90, 0xA8, 0x7D, 0xC9, 0x08, 0x7D, 0xC9, 0xA8, 0xD7, 0x9F, 0x87, 0xD9,
	0x0C, 0x8A, 0x7C, 0x90, 0x8A, 0x7D, 0x90, 0xF8, 0x7D, 0x90, 0xA8, 0x79,
	0x0C, 0x87, 0xAD, 0x90, 0x87, 0x90, 0xD8, 0x7C, 0xA9, 0x0D, 0x8C, 0x7A,
	0x90, 0xDC, 0x87, 0xA8
};

inline int ObfuscateInt(BYTE* value) {
	BYTE XORIndexValues[4] = { 0x04, 0x0A, 0x08, 0x0B };
	int indexFuckery = 0x24;

	for (int i = 0; i < 4; i++) {
		indexFuckery -= 4;
		value[i] ^= XORTable[i + indexFuckery];
		value[i] ^= XORTable[i + (i * 2) + indexFuckery];
		value[i] ^= XORTable[XORIndexValues[i] ^ indexFuckery];
	}
	return *(int*)&value[0];
}

void reverseBytes(unsigned char *start, int size)
{
	unsigned char *istart = start, *iend = istart + size;
	std::reverse(istart, iend);
}